<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[회고] next step ATDD with Spring 2주차 | Crispy bLog</title><meta name=keywords content="JAVA,Spring,ATDD"><meta name=description content="TL;DR 인수 테스트와 함께 TDD를 함께 해보는 작업 진행 순서를 가진 데이터의 구현 팁 외부 의존성을 도메인 객체에서 활용하는 방법 배운 것 나는 평소에 outside in 테스트를 하고 있었다. inside out/outside in 인수 테스트를 이용해 테스트를 작성하는 방식으로 inside out, outside in 방법이 있습니다. inside out 방법은 도메인 객체부터 차근 차근 테스트를 쌓아 올리는 방식이고, outside in은 그 반대입니다. outside in 테스트의 과정은 웹프로젝트에서 아래와 같이 진행되었습니다.
컨트롤러를 작성한다. 서비스를 작성한다."><meta name=author content="Crispy"><link rel=canonical href=https://heozeop.github.io/post/experience-second-week-of-next-step-atdd/><link crossorigin=anonymous href=/assets/css/stylesheet.d7fb4cbf980fe688a21621b06a795933c4e6bb2d4070ec940667af1715d84af2.css integrity="sha256-1/tMv5gP5oiiFiGwanlZM8Tmuy1AcOyUBmevFxXYSvI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://heozeop.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://heozeop.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://heozeop.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://heozeop.github.io/apple-touch-icon.png><link rel=mask-icon href=https://heozeop.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="[회고] next step ATDD with Spring 2주차"><meta property="og:description" content="TL;DR 인수 테스트와 함께 TDD를 함께 해보는 작업 진행 순서를 가진 데이터의 구현 팁 외부 의존성을 도메인 객체에서 활용하는 방법 배운 것 나는 평소에 outside in 테스트를 하고 있었다. inside out/outside in 인수 테스트를 이용해 테스트를 작성하는 방식으로 inside out, outside in 방법이 있습니다. inside out 방법은 도메인 객체부터 차근 차근 테스트를 쌓아 올리는 방식이고, outside in은 그 반대입니다. outside in 테스트의 과정은 웹프로젝트에서 아래와 같이 진행되었습니다.
컨트롤러를 작성한다. 서비스를 작성한다."><meta property="og:type" content="article"><meta property="og:url" content="https://heozeop.github.io/post/experience-second-week-of-next-step-atdd/"><meta property="og:image" content="https://heozeop.github.io/static/%ED%94%84%EB%A1%9C%ED%95%84%20%EC%9D%B4%EB%AF%B8%EC%A7%80.jpeg"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-02-12T19:07:19+09:00"><meta property="article:modified_time" content="2024-02-12T19:07:19+09:00"><meta property="og:site_name" content="Crispy bLog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://heozeop.github.io/static/%ED%94%84%EB%A1%9C%ED%95%84%20%EC%9D%B4%EB%AF%B8%EC%A7%80.jpeg"><meta name=twitter:title content="[회고] next step ATDD with Spring 2주차"><meta name=twitter:description content="TL;DR 인수 테스트와 함께 TDD를 함께 해보는 작업 진행 순서를 가진 데이터의 구현 팁 외부 의존성을 도메인 객체에서 활용하는 방법 배운 것 나는 평소에 outside in 테스트를 하고 있었다. inside out/outside in 인수 테스트를 이용해 테스트를 작성하는 방식으로 inside out, outside in 방법이 있습니다. inside out 방법은 도메인 객체부터 차근 차근 테스트를 쌓아 올리는 방식이고, outside in은 그 반대입니다. outside in 테스트의 과정은 웹프로젝트에서 아래와 같이 진행되었습니다.
컨트롤러를 작성한다. 서비스를 작성한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://heozeop.github.io/post/"},{"@type":"ListItem","position":2,"name":"[회고] next step ATDD with Spring 2주차","item":"https://heozeop.github.io/post/experience-second-week-of-next-step-atdd/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[회고] next step ATDD with Spring 2주차","name":"[회고] next step ATDD with Spring 2주차","description":"TL;DR 인수 테스트와 함께 TDD를 함께 해보는 작업 진행 순서를 가진 데이터의 구현 팁 외부 의존성을 도메인 객체에서 활용하는 방법 배운 것 나는 평소에 outside in 테스트를 하고 있었다. inside out/outside in 인수 테스트를 이용해 테스트를 작성하는 방식으로 inside out, outside in 방법이 있습니다. inside out 방법은 도메인 객체부터 차근 차근 테스트를 쌓아 올리는 방식이고, outside in은 그 반대입니다. outside in 테스트의 과정은 웹프로젝트에서 아래와 같이 진행되었습니다.\n컨트롤러를 작성한다. 서비스를 작성한다.","keywords":["JAVA","Spring","ATDD"],"articleBody":"TL;DR 인수 테스트와 함께 TDD를 함께 해보는 작업 진행 순서를 가진 데이터의 구현 팁 외부 의존성을 도메인 객체에서 활용하는 방법 배운 것 나는 평소에 outside in 테스트를 하고 있었다. inside out/outside in 인수 테스트를 이용해 테스트를 작성하는 방식으로 inside out, outside in 방법이 있습니다. inside out 방법은 도메인 객체부터 차근 차근 테스트를 쌓아 올리는 방식이고, outside in은 그 반대입니다. outside in 테스트의 과정은 웹프로젝트에서 아래와 같이 진행되었습니다.\n컨트롤러를 작성한다. 서비스를 작성한다. 서비스에 대한 유닛 테스트를 작성하며 작업한다. 이때, dependency는 Mock 객체로 대신한다. 코드 작성을 마무리한다. 이러한 과정을 가진 outside in 방식의 단점은 아래와 같았습니다.\n장점 fake 객체를 이용해 항상 성공하는 테스트를 만들 수 있다. 현재의 지식을 기반으로 빠르게 테스트를 작성할 수 있다. 단점 데이터 구조의 변경등 작은 변경들에 영향을 크게 받는다. 테스트에 통과하더라도 실제 상황에서 오류가 안나리라는 보장이 없다. 자칫 서비스가 두꺼워질 수 있다. 이에 반해 inside out의 테스트는 도메인을 먼저 설계한다는 측면에서 차이점이 있었습니다. inside out 방식의 테스트 과정은 아래와 같습니다.\n도메인을 설계한다. 테스트를 쌓아 올리며 도메인을 구현한다. 서비스와 컨트롤러를 차례로 쌓아 올린다. 그 결과, 아래와 같은 장단점을 지닌다고 생각했습니다.\n장점 견고한 도메인을 구현할 수 있다. 의존의 방향성이 도메인을 향하도록 서비스를 구현할 수 있다. 단점 도메인 이해도가 적다면 초기 설계가 어렵다. inside out 방식을 연습하자. 이번 과정을 통해 제가 평소 outside in방식으로 테스트를 짜왔다는 것을 알게 되었습니다. 두 방식을 비교하였을때, inside out 방식이 상황에 따라 더 좋은 경우가 많을 것 같다고 생각하였습니다. 또한 숙련도의 측면에서 inside out 방식을 연습하는게 이번 과정에서 얻어갈 수 있는 핵심이라는 생각이 들었습니다.\n결과적으로, 저는 앞으로 남은 과정에서 inside out 방식의 설계를 해보려고 합니다.\n순서가 지켜진다고 가정하자. 지하철 노선 미션 이 내용의 설명을 위해서는 미션을 잠시 소개할 필요가 있습니다. ‘노선’에는 여러개의 ‘구간’이 존재합니다. 이 ‘구간’은 상행역과 하행역 정보를 가지고 있습니다. 미션은 노선의 처음/끝/가운데 구간에 역을 추가/삭제하는 것입니다.\n저는 미션을 진행하며 구간의 순서를 저장할 때 지켜주지 않고, 추후 조회할때 정렬하는 방법을 생각했습니다. 해당 접근은 결과적으로 구간의 삭제시 코드의 복잡도를 높이는 결과를 초래했습니다. 아래는 제가 짰던 코드의 일부를 발췌한 내용입니다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 public void removeStation(Station station) { final Optional\u003cSection\u003e sectionWithUpStation = sections.stream().filter(section -\u003e section.getUpStation() == station).findAny(); final Optional\u003cSection\u003e sectionWithDownStation = sections.stream().filter(section -\u003e section.getDownStation() == station).findAny(); if (sectionWithUpStation.isEmpty() \u0026\u0026 sectionWithDownStation.isEmpty()) { throw new EntityNotFoundException(); } if (sectionWithUpStation.isPresent()) { filterSection(sectionWithUpStation.get()); } if (sectionWithDownStation.isPresent()) { filterSection(sectionWithDownStation.get()); } if(sectionWithUpStation.isPresent() \u0026\u0026 sectionWithDownStation.isPresent()) { addSection( sectionWithDownStation.get().getUpStation(), sectionWithUpStation.get().getDownStation(), sectionWithUpStation.get().getDistance() + sectionWithDownStation.get().getDistance() ); } } 제가 생각한 이 코드의 문제점은 여기서 어떤 케이스를 왜 처리하는지 알 수 없다는 점입니다. if 구문들을 보았을 때 어떤 경우를 처리하는지 알기 위해서는 기획을 알아야 할 필요가 있습니다. 저는 이 부분이 마음에 안들었고, 다른 풀이를 찾아보기 시작했습니다. 그렇게 다른 분의 풀이를 찾게 되었습니다. 기존 제 코드 보다 맥락을 훨씬 더 잘 알 수 있다는 느낌이 들었습니다. 참고하여 리펙토링한 결과는 아래와 같습니다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 public void removeStation(Station station) { if (isFirstStation(station)) { remove(getFirstSection()); return; } if(isLastStation(station)) { remove(getLastSection()); return; } removeStationInTheMiddle(station); } 핵심은 순서가 유지된다는 가정 이 설계의 핵심은 노선내 구간의 순서가 항상 유지 된다는 가정을 추가한 것이었습니다. 첫번째 역을 찾을때 0번 구간을 보면 되고, 마지막 역을 찾을때 n-1번 구간을 찾으면 됩니다. 이렇듯 가정 하나를 추가하여 직관적인 코드를 생산해 낸 것입니다.\n저도 앞으로 순서가 유지되어야 하는 경우, 순서가 항상 유지된다는 가정도 우선 고려해 봐야겠습니다.\n외부 의존성을 도메인 객체에서 활용하는 법 빠른 경로 찾기 미션 이번 미션은 빠른 경로찾기 미션이었습니다. 역의 아이디 2개가 주어졌을 때, 2개 역 간의 가장 빠른 경로를 찾아내는 것입니다. 이 로직을 구현하기 위해서는 다잌스트라를 활용할 수 있습니다. 이걸 직접 구현할 수도 있겠지만, 강의의 목적에 따라 라이브러리를 사용하기로 하였습니다. 그렇다면 라이브러리로 사용하였을 때, 어떻게 도메인에서 이용하게 만들어야 할까요?\n의존성 역전하기 저는 그 방법으로 interface와 abstract class를 고려했습니다. 외부 라이브러리에 대한 의존성을 역전시켜, 도메인이 외부 라이브러리 변경에 취약하지 않도록 만들고 싶어 해당 방법을 택했습니다. 이중 abstract class를 이용했는데, 요구 조건에 validation 로직을 다른 구현체에서도 사용해야 할 것이라는 생각 때문이었습니다.\n하지만 이 방법 역시 서비스 단에서는 구현체를 생성해 할당한다는 점에서 완벽하게 OCP나 DIP를 지킨 것은 아니었습니다. 배움이 짧아 아쉽지만 다음에 좀 더 학습해서 좋은 구조를 만들어 봐야겠다고 생각하였습니다.\n느낀 것 객체 지향적으로 설계할 수 있겠다는 기대감 기존에는 저는 서비스에 모든 validation과 로직을 때려박는 사람이었습니다. 그렇게 하면 빠르게 구현은 가능했기 때문에, 단점을 외면하였습니다. 결과적으로 도메인 레이어가 서비스에 강하게 결합된 코드를 만들었고, 저조차도 수정이 꺼려지는 상황이 되었습니다.\n앞으로는 좀 더 객체 지향적으로 구현해볼 수 있겠다는 생각이 많이 들었습니다. 물론 레거시 코드를 유지보수하는 단계에서는 적용이 어렵겠으나, 새로운 프로젝트를 진행하면서는 객체지향 설계가 가능할 것이라는 기대감이 듭니다.\nATDD 기반 테스트를 짤 수 있겠다는 자신감 기존에는 기존에는 해봐야 mock 객체를 이용한 unit 테스트만 잔뜩 만들었습니다. 결과적으로 테스트는 유기 되었고, 테스트에 대한 회의감 마져 들었던 상황이었습니다.\n앞으로는 몇 번의 연습을 통해 ATDD를 이용해 요구사항을 정리하고 테스트를 구현해 볼 수 있겠다는 자신감이 스멀스멀 올라옵니다. 기대만큼 잘되었으면 좋겠네요!\n총평 ATDD 만족도 2주차 만족 ","wordCount":"776","inLanguage":"en","datePublished":"2024-02-12T19:07:19+09:00","dateModified":"2024-02-12T19:07:19+09:00","author":{"@type":"Person","name":"Crispy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://heozeop.github.io/post/experience-second-week-of-next-step-atdd/"},"publisher":{"@type":"Organization","name":"Crispy bLog","logo":{"@type":"ImageObject","url":"https://heozeop.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://heozeop.github.io/ accesskey=h title="Crispy bLog (Alt + H)">Crispy bLog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://heozeop.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://heozeop.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://heozeop.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://heozeop.github.io/post/>Posts</a></div><h1 class=post-title>[회고] next step ATDD with Spring 2주차</h1><div class=post-meta><span title='2024-02-12 19:07:19 +0900 KST'>February 12, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;776 words&nbsp;·&nbsp;Crispy&nbsp;|&nbsp;<a href=https://github.com/heozeop/I-want-to-know-why/content/post/experience-second-week-of-next-step-atdd.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h1 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h1><ul><li>인수 테스트와 함께 TDD를 함께 해보는 작업 진행</li><li>순서를 가진 데이터의 구현 팁</li><li>외부 의존성을 도메인 객체에서 활용하는 방법</li></ul><h1 id=배운-것>배운 것<a hidden class=anchor aria-hidden=true href=#배운-것>#</a></h1><h2 id=나는-평소에-outside-in-테스트를-하고-있었다>나는 평소에 outside in 테스트를 하고 있었다.<a hidden class=anchor aria-hidden=true href=#나는-평소에-outside-in-테스트를-하고-있었다>#</a></h2><h3 id=inside-outoutside-in>inside out/outside in<a hidden class=anchor aria-hidden=true href=#inside-outoutside-in>#</a></h3><p>인수 테스트를 이용해 테스트를 작성하는 방식으로 inside out, outside in 방법이 있습니다.
inside out 방법은 도메인 객체부터 차근 차근 테스트를 쌓아 올리는 방식이고, outside in은 그 반대입니다.
outside in 테스트의 과정은 웹프로젝트에서 아래와 같이 진행되었습니다.</p><ol><li>컨트롤러를 작성한다.</li><li>서비스를 작성한다.</li><li>서비스에 대한 유닛 테스트를 작성하며 작업한다. 이때, dependency는 Mock 객체로 대신한다.</li><li>코드 작성을 마무리한다.</li></ol><p>이러한 과정을 가진 outside in 방식의 단점은 아래와 같았습니다.</p><ul><li>장점<ol><li>fake 객체를 이용해 항상 성공하는 테스트를 만들 수 있다.</li><li>현재의 지식을 기반으로 빠르게 테스트를 작성할 수 있다.</li></ol></li><li>단점<ol><li>데이터 구조의 변경등 작은 변경들에 영향을 크게 받는다.</li><li>테스트에 통과하더라도 실제 상황에서 오류가 안나리라는 보장이 없다.</li><li>자칫 서비스가 두꺼워질 수 있다.</li></ol></li></ul><p>이에 반해 inside out의 테스트는 도메인을 먼저 설계한다는 측면에서 차이점이 있었습니다.
inside out 방식의 테스트 과정은 아래와 같습니다.</p><ol><li>도메인을 설계한다.</li><li>테스트를 쌓아 올리며 도메인을 구현한다.</li><li>서비스와 컨트롤러를 차례로 쌓아 올린다.</li></ol><p>그 결과, 아래와 같은 장단점을 지닌다고 생각했습니다.</p><ul><li>장점<ol><li>견고한 도메인을 구현할 수 있다.</li><li>의존의 방향성이 도메인을 향하도록 서비스를 구현할 수 있다.</li></ol></li><li>단점<ol><li>도메인 이해도가 적다면 초기 설계가 어렵다.</li></ol></li></ul><h3 id=inside-out-방식을-연습하자>inside out 방식을 연습하자.<a hidden class=anchor aria-hidden=true href=#inside-out-방식을-연습하자>#</a></h3><p>이번 과정을 통해 제가 평소 outside in방식으로 테스트를 짜왔다는 것을 알게 되었습니다.
두 방식을 비교하였을때, inside out 방식이 상황에 따라 더 좋은 경우가 많을 것 같다고 생각하였습니다.
또한 숙련도의 측면에서 inside out 방식을 연습하는게 이번 과정에서 얻어갈 수 있는 핵심이라는 생각이 들었습니다.</p><p>결과적으로, 저는 앞으로 남은 과정에서 inside out 방식의 설계를 해보려고 합니다.</p><h2 id=순서가-지켜진다고-가정하자>순서가 지켜진다고 가정하자.<a hidden class=anchor aria-hidden=true href=#순서가-지켜진다고-가정하자>#</a></h2><h3 id=지하철-노선-미션>지하철 노선 미션<a hidden class=anchor aria-hidden=true href=#지하철-노선-미션>#</a></h3><p>이 내용의 설명을 위해서는 미션을 잠시 소개할 필요가 있습니다.
&lsquo;노선&rsquo;에는 여러개의 &lsquo;구간&rsquo;이 존재합니다. 이 &lsquo;구간&rsquo;은 상행역과 하행역 정보를 가지고 있습니다.
미션은 노선의 처음/끝/가운데 구간에 역을 추가/삭제하는 것입니다.</p><p>저는 미션을 진행하며 구간의 순서를 저장할 때 지켜주지 않고, 추후 조회할때 정렬하는 방법을 생각했습니다.
해당 접근은 결과적으로 구간의 삭제시 코드의 복잡도를 높이는 결과를 초래했습니다.
아래는 제가 짰던 코드의 일부를 발췌한 내용입니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JAVA data-lang=JAVA><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>removeStation</span><span class=o>(</span><span class=n>Station</span> <span class=n>station</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>Optional</span><span class=o>&lt;</span><span class=n>Section</span><span class=o>&gt;</span> <span class=n>sectionWithUpStation</span> <span class=o>=</span> <span class=n>sections</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>filter</span><span class=o>(</span><span class=n>section</span> <span class=o>-&gt;</span> <span class=n>section</span><span class=o>.</span><span class=na>getUpStation</span><span class=o>()</span> <span class=o>==</span> <span class=n>station</span><span class=o>).</span><span class=na>findAny</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>Optional</span><span class=o>&lt;</span><span class=n>Section</span><span class=o>&gt;</span> <span class=n>sectionWithDownStation</span> <span class=o>=</span> <span class=n>sections</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>filter</span><span class=o>(</span><span class=n>section</span> <span class=o>-&gt;</span> <span class=n>section</span><span class=o>.</span><span class=na>getDownStation</span><span class=o>()</span> <span class=o>==</span> <span class=n>station</span><span class=o>).</span><span class=na>findAny</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>sectionWithUpStation</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>()</span> <span class=o>&amp;&amp;</span> <span class=n>sectionWithDownStation</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>EntityNotFoundException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>sectionWithUpStation</span><span class=o>.</span><span class=na>isPresent</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>filterSection</span><span class=o>(</span><span class=n>sectionWithUpStation</span><span class=o>.</span><span class=na>get</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>sectionWithDownStation</span><span class=o>.</span><span class=na>isPresent</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>filterSection</span><span class=o>(</span><span class=n>sectionWithDownStation</span><span class=o>.</span><span class=na>get</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=n>sectionWithUpStation</span><span class=o>.</span><span class=na>isPresent</span><span class=o>()</span> <span class=o>&amp;&amp;</span> <span class=n>sectionWithDownStation</span><span class=o>.</span><span class=na>isPresent</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>addSection</span><span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=n>sectionWithDownStation</span><span class=o>.</span><span class=na>get</span><span class=o>().</span><span class=na>getUpStation</span><span class=o>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>sectionWithUpStation</span><span class=o>.</span><span class=na>get</span><span class=o>().</span><span class=na>getDownStation</span><span class=o>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>sectionWithUpStation</span><span class=o>.</span><span class=na>get</span><span class=o>().</span><span class=na>getDistance</span><span class=o>()</span> <span class=o>+</span> <span class=n>sectionWithDownStation</span><span class=o>.</span><span class=na>get</span><span class=o>().</span><span class=na>getDistance</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>제가 생각한 이 코드의 문제점은 여기서 어떤 케이스를 왜 처리하는지 알 수 없다는 점입니다.
if 구문들을 보았을 때 어떤 경우를 처리하는지 알기 위해서는 기획을 알아야 할 필요가 있습니다.
저는 이 부분이 마음에 안들었고, 다른 풀이를 찾아보기 시작했습니다. 그렇게 다른 분의 풀이를 찾게 되었습니다.
기존 제 코드 보다 맥락을 훨씬 더 잘 알 수 있다는 느낌이 들었습니다. 참고하여 리펙토링한 결과는 아래와 같습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>removeStation</span><span class=o>(</span><span class=n>Station</span> <span class=n>station</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>isFirstStation</span><span class=o>(</span><span class=n>station</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>remove</span><span class=o>(</span><span class=n>getFirstSection</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=n>isLastStation</span><span class=o>(</span><span class=n>station</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>remove</span><span class=o>(</span><span class=n>getLastSection</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>removeStationInTheMiddle</span><span class=o>(</span><span class=n>station</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=핵심은-순서가-유지된다는-가정>핵심은 순서가 유지된다는 가정<a hidden class=anchor aria-hidden=true href=#핵심은-순서가-유지된다는-가정>#</a></h3><p>이 설계의 핵심은 노선내 구간의 순서가 항상 유지 된다는 가정을 추가한 것이었습니다.
첫번째 역을 찾을때 0번 구간을 보면 되고, 마지막 역을 찾을때 n-1번 구간을 찾으면 됩니다. 이렇듯 가정 하나를 추가하여 직관적인 코드를 생산해 낸 것입니다.</p><p>저도 앞으로 순서가 유지되어야 하는 경우, 순서가 항상 유지된다는 가정도 우선 고려해 봐야겠습니다.</p><h2 id=외부-의존성을-도메인-객체에서-활용하는-법>외부 의존성을 도메인 객체에서 활용하는 법<a hidden class=anchor aria-hidden=true href=#외부-의존성을-도메인-객체에서-활용하는-법>#</a></h2><h3 id=빠른-경로-찾기-미션>빠른 경로 찾기 미션<a hidden class=anchor aria-hidden=true href=#빠른-경로-찾기-미션>#</a></h3><p>이번 미션은 빠른 경로찾기 미션이었습니다. 역의 아이디 2개가 주어졌을 때, 2개 역 간의 가장 빠른 경로를 찾아내는 것입니다.
이 로직을 구현하기 위해서는 다잌스트라를 활용할 수 있습니다. 이걸 직접 구현할 수도 있겠지만, 강의의 목적에 따라 라이브러리를 사용하기로 하였습니다.
그렇다면 라이브러리로 사용하였을 때, 어떻게 도메인에서 이용하게 만들어야 할까요?</p><h3 id=의존성-역전하기>의존성 역전하기<a hidden class=anchor aria-hidden=true href=#의존성-역전하기>#</a></h3><p>저는 그 방법으로 interface와 abstract class를 고려했습니다.
외부 라이브러리에 대한 의존성을 역전시켜, 도메인이 외부 라이브러리 변경에 취약하지 않도록 만들고 싶어 해당 방법을 택했습니다.
이중 abstract class를 이용했는데, 요구 조건에 validation 로직을 다른 구현체에서도 사용해야 할 것이라는 생각 때문이었습니다.</p><p>하지만 이 방법 역시 서비스 단에서는 구현체를 생성해 할당한다는 점에서 완벽하게 OCP나 DIP를 지킨 것은 아니었습니다.
배움이 짧아 아쉽지만 다음에 좀 더 학습해서 좋은 구조를 만들어 봐야겠다고 생각하였습니다.</p><h1 id=느낀-것>느낀 것<a hidden class=anchor aria-hidden=true href=#느낀-것>#</a></h1><h2 id=객체-지향적으로-설계할-수-있겠다는-기대감>객체 지향적으로 설계할 수 있겠다는 기대감<a hidden class=anchor aria-hidden=true href=#객체-지향적으로-설계할-수-있겠다는-기대감>#</a></h2><h3 id=기존에는>기존에는<a hidden class=anchor aria-hidden=true href=#기존에는>#</a></h3><p>저는 서비스에 모든 validation과 로직을 때려박는 사람이었습니다.
그렇게 하면 빠르게 구현은 가능했기 때문에, 단점을 외면하였습니다.
결과적으로 도메인 레이어가 서비스에 강하게 결합된 코드를 만들었고, 저조차도 수정이 꺼려지는 상황이 되었습니다.</p><h3 id=앞으로는>앞으로는<a hidden class=anchor aria-hidden=true href=#앞으로는>#</a></h3><p>좀 더 객체 지향적으로 구현해볼 수 있겠다는 생각이 많이 들었습니다.
물론 레거시 코드를 유지보수하는 단계에서는 적용이 어렵겠으나, 새로운 프로젝트를 진행하면서는 객체지향 설계가 가능할 것이라는 기대감이 듭니다.</p><h2 id=atdd-기반-테스트를-짤-수-있겠다는-자신감>ATDD 기반 테스트를 짤 수 있겠다는 자신감<a hidden class=anchor aria-hidden=true href=#atdd-기반-테스트를-짤-수-있겠다는-자신감>#</a></h2><h3 id=기존에는-1>기존에는<a hidden class=anchor aria-hidden=true href=#기존에는-1>#</a></h3><p>기존에는 해봐야 mock 객체를 이용한 unit 테스트만 잔뜩 만들었습니다.
결과적으로 테스트는 유기 되었고, 테스트에 대한 회의감 마져 들었던 상황이었습니다.</p><h3 id=앞으로는-1>앞으로는<a hidden class=anchor aria-hidden=true href=#앞으로는-1>#</a></h3><p>몇 번의 연습을 통해 ATDD를 이용해 요구사항을 정리하고 테스트를 구현해 볼 수 있겠다는 자신감이 스멀스멀 올라옵니다.
기대만큼 잘되었으면 좋겠네요!</p><h1 id=총평>총평<a hidden class=anchor aria-hidden=true href=#총평>#</a></h1><h2 id=atdd-만족도>ATDD 만족도<a hidden class=anchor aria-hidden=true href=#atdd-만족도>#</a></h2><h3 id=2주차>2주차<a hidden class=anchor aria-hidden=true href=#2주차>#</a></h3><ul><li>만족</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://heozeop.github.io/tags/next-step-atdd-with-spring/>next step ATDD with Spring</a></li></ul><nav class=paginav><a class=prev href=https://heozeop.github.io/post/experience-third-and-last-week-of-next-step/><span class=title>« Prev</span><br><span>[회고] next step ATDD with Spring 3,4주차</span></a>
<a class=next href=https://heozeop.github.io/post/research-aws-upload/><span class=title>Next »</span><br><span>AWS에서 aurora database의 Major 버전을 업그레이드하는 방법</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share [회고] next step ATDD with Spring 2주차 on twitter" href="https://twitter.com/intent/tweet/?text=%5b%ed%9a%8c%ea%b3%a0%5d%20next%20step%20ATDD%20with%20Spring%202%ec%a3%bc%ec%b0%a8&url=https%3a%2f%2fheozeop.github.io%2fpost%2fexperience-second-week-of-next-step-atdd%2f&hashtags=nextstepATDDwithSpring"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [회고] next step ATDD with Spring 2주차 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fheozeop.github.io%2fpost%2fexperience-second-week-of-next-step-atdd%2f&title=%5b%ed%9a%8c%ea%b3%a0%5d%20next%20step%20ATDD%20with%20Spring%202%ec%a3%bc%ec%b0%a8&summary=%5b%ed%9a%8c%ea%b3%a0%5d%20next%20step%20ATDD%20with%20Spring%202%ec%a3%bc%ec%b0%a8&source=https%3a%2f%2fheozeop.github.io%2fpost%2fexperience-second-week-of-next-step-atdd%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [회고] next step ATDD with Spring 2주차 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fheozeop.github.io%2fpost%2fexperience-second-week-of-next-step-atdd%2f&title=%5b%ed%9a%8c%ea%b3%a0%5d%20next%20step%20ATDD%20with%20Spring%202%ec%a3%bc%ec%b0%a8"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [회고] next step ATDD with Spring 2주차 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fheozeop.github.io%2fpost%2fexperience-second-week-of-next-step-atdd%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [회고] next step ATDD with Spring 2주차 on whatsapp" href="https://api.whatsapp.com/send?text=%5b%ed%9a%8c%ea%b3%a0%5d%20next%20step%20ATDD%20with%20Spring%202%ec%a3%bc%ec%b0%a8%20-%20https%3a%2f%2fheozeop.github.io%2fpost%2fexperience-second-week-of-next-step-atdd%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [회고] next step ATDD with Spring 2주차 on telegram" href="https://telegram.me/share/url?text=%5b%ed%9a%8c%ea%b3%a0%5d%20next%20step%20ATDD%20with%20Spring%202%ec%a3%bc%ec%b0%a8&url=https%3a%2f%2fheozeop.github.io%2fpost%2fexperience-second-week-of-next-step-atdd%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><script src=https://utteranc.es/client.js repo=heozeop/heozeop.github.io issue-term=title label=Comment theme=preferred-color-scheme crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://heozeop.github.io/>Crispy bLog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>